# Sefon Collections & Artists Scraper

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∏ –ø–æ–¥–±–æ—Ä–æ–∫ —Å sefon.pro.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ `puppeteer`, —á—Ç–æ –∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–µ–π–ø–µ—Ä–∞:

```powershell
npm install puppeteer
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

```powershell
node tools/sefon-collections-scraper.js --url=/artists/ --output=artists.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 90 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π —Å —Ñ–æ—Ç–æ –∏ —Å—Å—ã–ª–∫–∞–º–∏

**–§–æ—Ä–º–∞—Ç JSON:**
```json
{
  "name": "MiyaGi",
  "url": "https://sefon.pro/artist/161-miyagi/",
  "photoUrl": "https://sefon.pro/img/artist_photos/miyagi.jpg",
  "source": "sefon.pro",
  "scrapedAt": "2025-12-04T07:20:51.513Z"
}
```

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–¥–±–æ—Ä–æ–∫

```powershell
node tools/sefon-collections-scraper.js --url=/collections/ --output=collections.json
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~48 –ø–æ–¥–±–æ—Ä–æ–∫ (–ù–æ–≤—ã–π –≥–æ–¥, –†–µ—Ç—Ä–æ, –†–∏–Ω–≥—Ç–æ–Ω—ã, –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Ç.–¥.)

**–§–æ—Ä–º–∞—Ç JSON:**
```json
{
  "title": "–ù–æ–≤—ã–π –≥–æ–¥",
  "url": "https://sefon.pro/collections/prazdniki/168-novyj-god/",
  "imageUrl": null,
  "source": "sefon.pro",
  "scrapedAt": "2025-12-04T07:22:21.974Z"
}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∫—Ä–µ–π–ø–µ—Ä–æ–º

–ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–¥–±–æ—Ä–æ–∫ –º–æ–∂–Ω–æ —Å–∫—Ä–µ–π–ø–∏—Ç—å —Ç—Ä–µ–∫–∏ –∏–∑ –∫–∞–∂–¥–æ–π:

```powershell
# 1. –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–¥–±–æ—Ä–∫–∏
node tools/sefon-collections-scraper.js --url=/collections/ --output=collections.json

# 2. –ß–∏—Ç–∞–µ–º JSON –∏ —Å–∫—Ä–µ–π–ø–∏–º –∫–∞–∂–¥—É—é –ø–æ–¥–±–æ—Ä–∫—É
# –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–¥–±–æ—Ä–∫–∏ "–ù–æ–≤—ã–π –≥–æ–¥"
node tools/sefon-scraper.js --url=/collections/prazdniki/168-novyj-god/ --limit=50 --output=new-year-tracks.json

# 3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç—Ä–µ–∫–∏ –≤ –ë–î
node tools/sefon-import.js --input=new-year-tracks.json --api=http://localhost:3001/api
```

## ‚öôÔ∏è –û–ø—Ü–∏–∏

| –û–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-------|----------|--------------|
| `--url=<path>` | `/artists/` –∏–ª–∏ `/collections/` | `/artists/` |
| `--output=<—Ñ–∞–π–ª>` | –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON | `null` (–≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å) |
| `--no-headless` | –ü–æ–∫–∞–∑–∞—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ | `false` (headless) |
| `--proxy=<url>` | –ü—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä | `null` |
| `--timeout=<–º—Å>` | –¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ | `30000` |

## üìä –ü—Ä–∏–º–µ—Ä—ã

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π —Å –ø—Ä–æ–∫—Å–∏

```powershell
node tools/sefon-collections-scraper.js --url=/artists/ --proxy=http://proxy:8080 --output=artists.json
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤ –∫–æ–Ω—Å–æ–ª–∏ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```powershell
node tools/sefon-collections-scraper.js --url=/collections/
```

### –û—Ç–ª–∞–¥–∫–∞ —Å –≤–∏–¥–∏–º—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º

```powershell
node tools/sefon-collections-scraper.js --url=/artists/ --no-headless
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏

–î–∞–Ω–Ω—ã–µ –æ–± –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –Ω–æ–≤–∏–Ω–∫–∏ –ª—é–±–∏–º—ã—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤ –≤–∞—à–µ–π –ë–î

### –ü–æ–¥–±–æ—Ä–∫–∏

–ü–æ–¥–±–æ—Ä–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:
- **–ü—Ä–∞–∑–¥–Ω–∏–∫–∏:** –ù–æ–≤—ã–π –≥–æ–¥, 8 –º–∞—Ä—Ç–∞, –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è
- **–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:** –ì—Ä—É—Å—Ç–Ω–∞—è, –í–µ—Å—ë–ª–∞—è, –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è
- **–ñ–∞–Ω—Ä—ã:** –†–æ–∫, –ü–æ–ø, –†—ç–ø, –î–∂–∞–∑
- **–û—Å–æ–±—ã–µ:** –†–∏–Ω–≥—Ç–æ–Ω—ã, –†–µ—Ç—Ä–æ, –ö—Ä–∞—Å–∏–≤–∞—è, –ö—Ä—É—Ç–∞—è

–ú–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–µ–π–ø–∏—Ç—å –≤—Å–µ —Ç—Ä–µ–∫–∏ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ–¥–±–æ—Ä–æ–∫ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞.

## üí° PowerShell –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–∫—Ä–µ–π–ø–∏–Ω–≥–∞ –ø–æ–¥–±–æ—Ä–æ–∫:

```powershell
# scrape-all-collections.ps1

# 1. –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–¥–±–æ—Ä–æ–∫
node tools/sefon-collections-scraper.js --url=/collections/ --output=temp/collections.json

# 2. –ß–∏—Ç–∞–µ–º JSON –∏ —Å–∫—Ä–µ–π–ø–∏–º –∫–∞–∂–¥—É—é –ø–æ–¥–±–æ—Ä–∫—É
$collections = Get-Content temp/collections.json | ConvertFrom-Json

foreach ($collection in $collections) {
    $url = $collection.url -replace 'https://sefon.pro', ''
    $filename = $collection.title -replace '[^\w\s-]', '' -replace '\s+', '_'
    
    Write-Host "`n–°–∫—Ä–µ–π–ø–∏–Ω–≥: $($collection.title)" -ForegroundColor Cyan
    
    node tools/sefon-scraper.js --url=$url --limit=30 --output="temp/$filename.json"
    
    # –ò–º–ø–æ—Ä—Ç –≤ –ë–î
    node tools/sefon-import.js --input="temp/$filename.json" --api=http://localhost:3001/api
    
    Start-Sleep -Seconds 5  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
}

Write-Host "`n‚úÖ –í—Å–µ –ø–æ–¥–±–æ—Ä–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!" -ForegroundColor Green
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Waiting for selector failed"

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç
node tools/sefon-collections-scraper.js --url=/collections/ --timeout=60000
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–≤–ª–µ—á–µ–Ω–æ 0 –∑–∞–ø–∏—Å–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å `--no-headless` –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

```powershell
node tools/sefon-collections-scraper.js --url=/collections/ --no-headless
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏:** ~5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è 90 –∑–∞–ø–∏—Å–µ–π
- **–ü–æ–¥–±–æ—Ä–∫–∏:** ~3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è 48 –∑–∞–ø–∏—Å–µ–π
- **–ü–∞–º—è—Ç—å:** ~200-300 MB (Chromium)

---

**–ì–æ—Ç–æ–≤–æ!** üéâ

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∏ –ø–æ–¥–±–æ—Ä–æ–∫ —Å sefon.pro.
