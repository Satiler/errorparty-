# CS2 Game State Integration - Автоматическая загрузка статистики

## Что это?
Game State Integration (GSI) позволяет CS2 автоматически отправлять статистику матчей на ваш сервер в реальном времени, как на csstats.gg.

## Установка (для игроков)

### Шаг 1: Создайте конфигурационный файл GSI

1. Откройте папку конфигураций CS2:
   ```
   C:\Program Files (x86)\Steam\steamapps\common\Counter-Strike Global Offensive\game\csgo\cfg
   ```

2. Создайте новый файл: `gamestate_integration_errorparty.cfg`

3. Вставьте следующее содержимое:

```json
"ErrorParty GSI Configuration"
{
  "uri" "https://errorparty.ru/api/gsi"
  "timeout" "5.0"
  "buffer"  "0.1"
  "throttle" "0.5"
  "heartbeat" "30.0"
  "auth"
  {
    "token" "YOUR_STEAM_ID_HERE"
  }
  "output"
  {
    "precision_time" "3"
    "precision_position" "1"
    "precision_vector" "3"
  }
  "data"
  {
    "provider"            "1"
    "map"                 "1"
    "round"               "1"
    "player_id"           "1"
    "player_state"        "1"
    "player_weapons"      "1"
    "player_match_stats"  "1"
    "allplayers"          "1"
  }
}
```

4. **ВАЖНО**: Замените `YOUR_STEAM_ID_HERE` на ваш Steam ID (можно посмотреть в профиле на сайте)

### Шаг 2: Перезапустите CS2

После создания файла перезапустите игру. Теперь после каждого матча статистика будет автоматически загружаться на сервер!

## Как это работает?

1. Вы играете матч в CS2
2. В конце матча CS2 автоматически отправляет данные на `https://errorparty.ru/api/gsi`
3. Сервер сохраняет статистику в базу данных
4. Квесты автоматически обновляются
5. История матчей доступна в профиле

## Что отслеживается?

- ✅ Убийства (Kills)
- ✅ Смерти (Deaths)
- ✅ Ассисты (Assists)
- ✅ MVP
- ✅ Раунды (выиграно/всего)
- ✅ Победа/Поражение
- ✅ Карта
- ⚠️ Хедшоты (приблизительно из Steam API)
- ⚠️ Урон (приблизительно из Steam API)

## Альтернативный метод (через Steam API)

Если GSI не работает, система автоматически подгружает статистику последнего матча через Steam API при каждом обновлении профиля (каждый час через CRON).

## Проблемы?

- **GSI не работает?** - Проверьте, что файл создан в правильной папке и CS2 перезапущен
- **Данные не загружаются?** - Убедитесь, что ваш Steam ID правильно указан в конфиге
- **Нет истории матчей?** - Новые матчи начнут записываться после установки GSI

## Для локального тестирования

Если тестируете локально, замените URI в конфиге на:
```
"uri" "http://localhost:3001/api/gsi"
```

## Безопасность

GSI отправляет только игровую статистику, никакой личной информации. Данные шифруются через HTTPS.
