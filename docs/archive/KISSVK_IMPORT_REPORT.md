# üéµ KissVK Import - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

**–î–∞—Ç–∞:** 4 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

---

## ‚úÖ –ß—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –ò–º–ø–æ—Ä—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤
- **–ò–∑–≤–ª–µ—á–µ–Ω–æ:** 24 —Ç—Ä–µ–∫–∞ —Å kissvk.top
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î:** 10 —Ç—Ä–µ–∫–æ–≤
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ kissvk.top

**–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏:**
1. Jakone, Kiliana - –ñ–∏–≥–∞–Ω—Å–∫–∞—è (ID: 7582)
2. ICEGERGERT, Zivert - –ë–ê–ù–ö (ID: 7583)
3. STXPNXY - –¢–ê4–¢–û REMIX 2025 (ID: 7584)
4. NEXTIME - –°–í–ï–¢–õ–ê–ù–ê! (ID: 7585)
5. Sabi, MIA BOYKA - –ë–∞–∑–æ–≤—ã–π –º–∏–Ω–∏–º—É–º (ID: 7586)
6. –í–∞–Ω—è –î–º–∏—Ç—Ä–∏–µ–Ω–∫–æ, –ê–Ω—è –ü–µ—Ä–µ—Å–∏–ª—å–¥ - –°–∏–ª—É—ç—Ç –∏–∑ –∫/—Ñ ¬´–ê–ª–∏—Å–∞ –≤ –°—Ç—Ä–∞–Ω–µ –ß—É–¥–µ—Å¬ª (ID: 7587)
7. MONA - –í–æ–∏–Ω –∏ –¥—Ä–∞–∫–æ–Ω OST ¬´–û–Ω–∏–∫—Å–æ–≤—ã–π —à—Ç–æ—Ä–º¬ª (ID: 7588)
8. MIA BOYKA - –Ø –°–ê–ú–ê–Ø (ID: 7589)
9. Aarne, Toxi$, Big Baby Tape - NOBODY (ID: 7590)
10. –í–∞–Ω—è –î–º–∏—Ç—Ä–∏–µ–Ω–∫–æ - –®—ë–ª–∫ (ID: 7591)

### 2. –°–æ–∑–¥–∞–Ω –ø–ª–µ–π–ª–∏—Å—Ç
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** KissVK Chart
- **ID:** 184
- **–¢—Ä–µ–∫–æ–≤:** 10
- **–¢–∏–ø:** auto (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)
- **–ü—É–±–ª–∏—á–Ω—ã–π:** –î–∞
- **URL:** `/music/playlists/184`

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ URL

–í—Å–µ —Ç—Ä–µ–∫–∏ –∏–º–µ—é—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ URL –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
encrypted:-2001963489_143963489
```

**–°–ª–µ–¥—Å—Ç–≤–∏—è:**
- ‚ùå MP3 —Ñ–∞–π–ª—ã –Ω–µ –±—ã–ª–∏ —Å–∫–∞—á–∞–Ω—ã
- ‚ùå –¢—Ä–µ–∫–∏ –Ω–µ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã –≤ –ø–ª–µ–µ—Ä–µ
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (title, artist, duration, coverUrl)

**–û—à–∏–±–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```
NotSupportedError: Failed to load because no supported source was found.
```

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ URL —á–µ—Ä–µ–∑ Puppeteer:

```javascript
async decryptTrackUrl(trackId, pageUrl) {
  const page = await this.getFreeBrowser();
  await page.goto(pageUrl);
  
  // –ù–∞—Ö–æ–¥–∏–º —Ç—Ä–µ–∫ –ø–æ ID
  const trackElement = await page.$(`[data-id="${trackId}"]`);
  
  // –ö–ª–∏–∫–∞–µ–º –Ω–∞ —Ç—Ä–µ–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
  await trackElement.click();
  
  // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ URL –≤ audio player
  await page.waitForFunction(() => {
    const audio = document.querySelector('#audio');
    return audio && audio.src && audio.src.startsWith('http');
  }, { timeout: 10000 });
  
  // –ü–æ–ª—É—á–∞–µ–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π URL
  const streamUrl = await page.evaluate(() => {
    return document.querySelector('#audio').src;
  });
  
  return streamUrl;
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞—á–∞—Ç—å MP3 —Ñ–∞–π–ª—ã
- ‚úÖ –¢—Ä–µ–∫–∏ —Å—Ç–∞–Ω—É—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚è±Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–æ (–Ω—É–∂–µ–Ω –∫–ª–∏–∫ –Ω–∞ –∫–∞–∂–¥—ã–π —Ç—Ä–µ–∫)
- üß† –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –º—É–∑—ã–∫–∏:
- ‚úÖ **Jamendo** (—É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω)
- ‚úÖ **LMusic.kz** (—É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω)
- ‚úÖ **AI Music Discovery** (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚ùì **Sefon.pro** (—Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢—Ä–µ–∫–æ–≤ –∏–∑–≤–ª–µ—á–µ–Ω–æ** | 24 |
| **–¢—Ä–µ–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ** | 10 |
| **MP3 —Å–∫–∞—á–∞–Ω–æ** | 0 (URL –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã) |
| **–ü–ª–µ–π–ª–∏—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ** | 1 (KissVK Chart) |
| **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã** | ~8 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ |
| **Browser pool** | 3 –±—Ä–∞—É–∑–µ—Ä–∞ Chromium |

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `decryptTrackUrl()` –≤ `kissvk-puppeteer.service.js`
2. –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `downloadAndSaveTrack()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è MP3

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–µ–∫–æ–≤
1. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤
2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å URL –¥–ª—è –≤—Å–µ—Ö 10 —Ç—Ä–µ–∫–æ–≤
3. –°–∫–∞—á–∞—Ç—å MP3 —Ñ–∞–π–ª—ã
4. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å–∏ –≤ –ë–î

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
1. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å retry –¥–ª—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–æ–∫
3. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

---

## üéØ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–ü–æ–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–µ–∫–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

```sql
-- –ù–∞–π—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ —Ç—Ä–µ–∫–∏
SELECT id, title, artist, provider, streamUrl, fileUrl 
FROM "Tracks" 
WHERE (streamUrl IS NOT NULL OR fileUrl IS NOT NULL OR filePath IS NOT NULL)
  AND provider != 'kissvk'
LIMIT 20;
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
```bash
# Jamendo
POST /api/admin/music/import
{ "source": "jamendo", "query": "popular", "limit": 20 }

# LMusic.kz  
POST /api/admin/music/import
{ "source": "lmusic", "query": "top", "limit": 20 }
```

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ URL
```
encrypted:-2001963489_143963489
           ‚Üë            ‚Üë
           ownerId      audioId
```

–§–æ—Ä–º–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç VK Audio ID: `{ownerId}_{audioId}`

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ VK Audio
KissVK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JS –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏. –ü—Ä–∏–º–µ—Ä–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
1. –ö–ª–∏–∫ –Ω–∞ —Ç—Ä–µ–∫ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ AJAX –∑–∞–ø—Ä–æ—Å–∞
2. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
3. JS —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –ª–æ–∫–∞–ª—å–Ω–æ
4. URL –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ `<audio>` —ç–ª–µ–º–µ–Ω—Ç

**–ù–∞—à –ø–æ–¥—Ö–æ–¥:** –ü—É—Å–∫–∞–π JS —Å–¥–µ–ª–∞–µ—Ç –≤—Å—é —Ä–∞–±–æ—Ç—É, –º—ã –ø—Ä–æ—Å—Ç–æ –∏–∑–≤–ª–µ—á—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## ‚úÖ –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤

1. **trigger-kissvk-import.js** - –°–∫—Ä–∏–ø—Ç —Ä—É—á–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
2. **check-kissvk-tracks.js** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–∫–æ–≤ –≤ –ë–î
3. **create-kissvk-playlist.js** - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞
4. **check-track-urls.js** - –ü—Ä–æ–≤–µ—Ä–∫–∞ URL —Ç—Ä–µ–∫–æ–≤

---

## üéµ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–ª–µ–π–ª–∏—Å—Ç "KissVK Chart" —Å–æ–∑–¥–∞–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω!**
- üì¶ 10 —Ç—Ä–µ–∫–æ–≤ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- üñºÔ∏è –û–±–ª–æ–∂–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- üìä –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚ö†Ô∏è **–¢—Ä–µ–∫–∏ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è** (–Ω—É–∂–Ω–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL)

**–î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ç—Ä–µ–∫–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è:**
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É URL (–º–µ—Ç–æ–¥ –æ–ø–∏—Å–∞–Ω –≤—ã—à–µ)
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç —Å–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º MP3
3. –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~15 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å:** –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL
