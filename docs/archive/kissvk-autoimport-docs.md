# üéµ KissVK –ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–π—Ç–∞ **kissvk.top** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–∞—à–µ–≥–æ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **–ò–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∞–ª—å–±–æ–º–æ–≤** 
- URL: `https://kissvk.top/new_albums`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–ª—å–±–æ–º–æ–≤
- –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∞–ª—å–±–æ–º–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –µ–≥–æ —Ç—Ä–µ–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (00:00, 06:00, 12:00, 18:00)

### 2. **–ò–º–ø–æ—Ä—Ç —á–∞—Ä—Ç–∞ —Ç—Ä–µ–∫–æ–≤**
- URL: `https://kissvk.top/tracks_chart`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ø-50 —Ç—Ä–µ–∫–æ–≤
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Ç—Ä–µ–∫–∞ –≤ —á–∞—Ä—Ç–µ
- –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç –¥–ª—è —á–∞—Ä—Ç–∞
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º 1 —á–∞—Å (01:00, 07:00, 13:00, 19:00)

### 3. **–ò–º–ø–æ—Ä—Ç —á–∞—Ä—Ç–∞ –∞–ª—å–±–æ–º–æ–≤**
- URL: `https://kissvk.top/albums_chart`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ø-30 –∞–ª—å–±–æ–º–æ–≤ –∏–∑ —á–∞—Ä—Ç–∞
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–µ—Ä–≤—ã–µ 5 —Ç—Ä–µ–∫–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∞–ª—å–±–æ–º–∞
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º 2 —á–∞—Å–∞ (02:00, 08:00, 14:00, 20:00)

### 4. **–ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–æ–≤**
- URL: `https://kissvk.top/?q={–∑–∞–ø—Ä–æ—Å}`
- –ü–æ–∏—Å–∫ –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é, –Ω–∞–∑–≤–∞–Ω–∏—é —Ç—Ä–µ–∫–∞ –∏–ª–∏ –∞–ª—å–±–æ–º–∞
- –ò–º–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

### 5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Ç—Ä–µ–∫–æ–≤**
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –Ω–æ–≤—ã–µ —Ç—Ä–µ–∫–∏
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kissvk-puppeteer.service.js  # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å —Å Puppeteer
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kissvk.service.js            # HTTP-—Å–µ—Ä–≤–∏—Å (–±–µ–∑ Puppeteer)
‚îÇ   ‚îú‚îÄ‚îÄ schedulers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kissvk-auto.scheduler.js     # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (cron)
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kissvk-import.controller.js  # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kissvk-import.routes.js      # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ       ‚îú‚îÄ‚îÄ Track.js                      # –ú–æ–¥–µ–ª—å —Ç—Ä–µ–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ Album.js                      # –ú–æ–¥–µ–ª—å –∞–ª—å–±–æ–º–∞
‚îÇ       ‚îî‚îÄ‚îÄ Playlist.js                   # –ú–æ–¥–µ–ª—å –ø–ª–µ–π–ª–∏—Å—Ç–∞
‚îî‚îÄ‚îÄ migrations/
    ‚îî‚îÄ‚îÄ add-kissvk-fields-to-albums.sql  # SQL –º–∏–≥—Ä–∞—Ü–∏—è
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
docker exec errorparty_postgres psql -U errorparty -d errorparty -f /app/migrations/add-kissvk-fields-to-albums.sql
```

–ò–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

```bash
docker cp backend/migrations/add-kissvk-fields-to-albums.sql errorparty_postgres:/tmp/
docker exec errorparty_postgres psql -U errorparty -d errorparty -f /tmp/add-kissvk-fields-to-albums.sql
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend

```bash
docker-compose restart backend
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:

```bash
docker logs errorparty_backend --tail 100 | grep -i kissvk
```

–ò–ª–∏ —á–µ—Ä–µ–∑ API:

```bash
curl http://localhost:3000/api/kissvk/scheduler/status
```

## üì° API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

#### GET `/api/kissvk/status`
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å Puppeteer —Å–µ—Ä–≤–∏—Å–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "status": "operational",
  "browserPool": {
    "size": 3,
    "active": 3,
    "busy": 0,
    "free": 3
  }
}
```

#### GET `/api/kissvk/scheduler/status`
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "scheduler": {
    "running": true,
    "tasks": [
      "import-new-albums-6h",
      "import-tracks-chart-6h",
      "import-albums-chart-6h",
      "auto-search-30min",
      "daily-full-sync"
    ]
  }
}
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞

#### POST `/api/kissvk/import/new-albums`
–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∞–ª—å–±–æ–º–æ–≤ –≤—Ä—É—á–Ω—É—é.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –∞–ª—å–±–æ–º–æ–≤: 5, —Ç—Ä–µ–∫–æ–≤: 47",
  "result": {
    "albums": 5,
    "tracks": 47,
    "errors": 0
  }
}
```

#### POST `/api/kissvk/import/tracks-chart`
–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç —á–∞—Ä—Ç–∞ —Ç—Ä–µ–∫–æ–≤.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç—Ä–µ–∫–æ–≤: 32, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: 18",
  "result": {
    "imported": 32,
    "existing": 18,
    "playlistId": 15,
    "errors": 0
  }
}
```

#### POST `/api/kissvk/import/albums-chart`
–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç —á–∞—Ä—Ç–∞ –∞–ª—å–±–æ–º–æ–≤.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –∞–ª—å–±–æ–º–æ–≤: 12, —Ç—Ä–µ–∫–æ–≤: 60",
  "result": {
    "albums": 12,
    "tracks": 60,
    "existing": 8,
    "errors": 0
  }
}
```

#### POST `/api/kissvk/import/search`
–ü–æ–∏—Å–∫ –∏ –∏–º–ø–æ—Ä—Ç —Ç—Ä–µ–∫–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "query": "–°–∫—Ä–∏–ø—Ç–æ–Ω–∏—Ç",
  "limit": 20
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç—Ä–µ–∫–æ–≤: 15",
  "query": "–°–∫—Ä–∏–ø—Ç–æ–Ω–∏—Ç",
  "found": 20,
  "imported": 15,
  "existing": 5,
  "errors": 0
}
```

## üìä –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|----------|
| –ù–æ–≤—ã–µ –∞–ª—å–±–æ–º—ã | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (00:00, 06:00, 12:00, 18:00) | –ò–º–ø–æ—Ä—Ç –∞–ª—å–±–æ–º–æ–≤ —Å /new_albums |
| –ß–∞—Ä—Ç —Ç—Ä–µ–∫–æ–≤ | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (01:00, 07:00, 13:00, 19:00) | –ò–º–ø–æ—Ä—Ç —Ç–æ–ø-50 —Ç—Ä–µ–∫–æ–≤ |
| –ß–∞—Ä—Ç –∞–ª—å–±–æ–º–æ–≤ | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (02:00, 08:00, 14:00, 20:00) | –ò–º–ø–æ—Ä—Ç —Ç–æ–ø-30 –∞–ª—å–±–æ–º–æ–≤ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Ç—Ä–µ–∫–æ–≤ | –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –Ω–æ–≤—ã—Ö —Ç—Ä–µ–∫–æ–≤ |
| –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è | –†–∞–∑ –≤ –¥–µ–Ω—å –≤ 04:00 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö |

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

–ü–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ–∫–∞ –∏–ª–∏ –∞–ª—å–±–æ–º–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ:
- **–¢—Ä–µ–∫–∏**: `title` + `artist`
- **–ê–ª—å–±–æ–º—ã**: `title` + `artist` + `provider='kissvk'`

### –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ URL

KissVK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ URL –¥–ª—è —Ç—Ä–µ–∫–æ–≤. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ URL (—Ñ–æ—Ä–º–∞—Ç `encrypted:trackId`)
2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Puppeteer –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ –∫–ª–∏–∫–∞ –ø–æ —Ç—Ä–µ–∫—É
3. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π URL –∏–∑ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π URL –≤ –±–∞–∑—É

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- –ü–æ–¥—Å—á–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–µ–∫–∞/–∞–ª—å–±–æ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–∞–ª—å—à–µ
- Graceful degradation: –µ—Å–ª–∏ URL –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ Tracks

–ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è KissVK:
- `provider` = 'kissvk'
- `providerTrackId` - ID —Ç—Ä–µ–∫–∞ –Ω–∞ KissVK
- `streamUrl` - URL –¥–ª—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è
- `coverUrl` - URL –æ–±–ª–æ–∂–∫–∏

### –¢–∞–±–ª–∏—Ü–∞ Albums

–ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è KissVK:
- `provider` = 'kissvk'
- `providerAlbumId` - ID –∞–ª—å–±–æ–º–∞ (playlist) –Ω–∞ KissVK
- `source` = 'kissvk.top'
- `uploadedBy` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (1 = system)

### –¢–∞–±–ª–∏—Ü–∞ Playlists

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–ª–µ–π–ª–∏—Å—Ç—ã:
- `KissVK Chart - {–¥–∞—Ç–∞}` - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —á–∞—Ä—Ç—ã —Ç—Ä–µ–∫–æ–≤
- `–¢–æ–ø KissVK 2025` - –æ–±—â–∏–π –ø–ª–µ–π–ª–∏—Å—Ç —Å —Ç–æ–ø-50 —Ç—Ä–µ–∫–∞–º–∏

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `docker-compose.yml` –∏–ª–∏ `.env`:

```env
# Puppeteer
PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true

# KissVK
KISSVK_BROWSER_POOL_SIZE=3  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–í —Ñ–∞–π–ª–µ `backend/src/schedulers/kissvk-auto.scheduler.js`:

```javascript
// –ò–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∞–ª—å–±–æ–º–æ–≤ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
const importNewAlbums = cron.schedule('0 */6 * * *', async () => {
  await this.importNewAlbums();
});
```

–§–æ—Ä–º–∞—Ç cron:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –º–∏–Ω—É—Ç–∞ (0-59)
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ —á–∞—Å (0-23)
‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ (1-31)
‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –º–µ—Å—è—Ü (1-12)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (0-6, 0=–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
* * * * *
```

–ü—Ä–∏–º–µ—Ä—ã:
- `0 */6 * * *` - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
- `*/30 * * * *` - –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- `0 4 * * *` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 04:00

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í—Å–µ –ª–æ–≥–∏ backend
docker logs errorparty_backend -f

# –¢–æ–ª—å–∫–æ KissVK –ª–æ–≥–∏
docker logs errorparty_backend --tail 100 | grep -i kissvk

# –õ–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
docker logs errorparty_backend 2>&1 | grep "–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫\|scheduler"
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á

–ß–µ—Ä–µ–∑ API (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Postman, curl –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä):

```bash
# –ò–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∞–ª—å–±–æ–º–æ–≤
curl -X POST http://localhost:3000/api/kissvk/import/new-albums \
  -H "Authorization: Bearer YOUR_TOKEN"

# –ò–º–ø–æ—Ä—Ç —á–∞—Ä—Ç–∞ —Ç—Ä–µ–∫–æ–≤
curl -X POST http://localhost:3000/api/kissvk/import/tracks-chart \
  -H "Authorization: Bearer YOUR_TOKEN"

# –ü–æ–∏—Å–∫ –∏ –∏–º–ø–æ—Ä—Ç
curl -X POST http://localhost:3000/api/kissvk/import/search \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{"query":"Miyagi","limit":10}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –ë–î

```sql
-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–∫–æ–≤ –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É
SELECT provider, COUNT(*) 
FROM "Tracks" 
GROUP BY provider;

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–ª—å–±–æ–º–æ–≤ KissVK
SELECT COUNT(*) 
FROM "Albums" 
WHERE provider='kissvk';

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏
SELECT id, artist, title, provider, "createdAt"
FROM "Tracks"
WHERE provider='kissvk'
ORDER BY id DESC
LIMIT 10;
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏

–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ API `/api/kissvk/scheduler/status`:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- –°—Ç–∞—Ç—É—Å –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –ø—É–ª–∞ Puppeteer
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ (–≤ –ª–æ–≥–∞—Ö)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ**: –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
2. **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ**: —Å—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–º–ø–æ—Ä—Ç–∞
3. **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö**: –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Graceful shutdown –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä–≤–∏—Å–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–æ–≤ Puppeteer

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –∏–º–ø–æ—Ä—Ç 30 –∞–ª—å–±–æ–º–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-20 –º–∏–Ω—É—Ç
2. **–†–µ—Å—É—Ä—Å—ã**: Puppeteer —Ç—Ä–µ–±—É–µ—Ç ~200MB RAM –Ω–∞ –±—Ä–∞—É–∑–µ—Ä
3. **–°–µ—Ç—å**: —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å kissvk.top
4. **–î—É–±–ª–∏–∫–∞—Ç—ã**: —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç—Ä–µ–∫–∏

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs errorparty_backend --tail 100`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç: `docker ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å kissvk.top –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend: `docker-compose restart backend`

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 04.12.2025  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot
