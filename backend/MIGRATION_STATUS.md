# –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –º–æ–¥—É–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `core/` —Å –±–∞–∑–æ–≤—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `shared/` —Å –æ–±—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `modules/` —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏
- ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã middleware, utils, config –≤ shared/

### –Ø–¥—Ä–æ (core/)
- ‚úÖ `app.js` - Express –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `server.js` - HTTP server –∏ –∑–∞–ø—É—Å–∫
- ‚úÖ `database.js` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- ‚úÖ `socket.js` - Socket.IO –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ `moduleLoader.js` - –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑—á–∏–∫ –º–æ–¥—É–ª–µ–π

### –ú–æ–¥—É–ª–∏ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ `auth` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Steam
- ‚úÖ `cs2` - Counter-Strike 2 —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ `quests` - —Å–∏—Å—Ç–µ–º–∞ –∫–≤–µ—Å—Ç–æ–≤
- ‚úÖ `user` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- ‚úÖ `teamspeak` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è TeamSpeak
- ‚úÖ `notifications` - push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ `home` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- ‚úÖ `admin` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `package.json` (–≤–µ—Ä—Å–∏—è 2.0.0)
- ‚úÖ –°–æ–∑–¥–∞–Ω `src/index.js` - –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –≤ shared/config/passport.js

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd backend
npm start
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
```bash
node src/index.js
```

### –û—Ç–∫–∞—Ç –Ω–∞ —Å—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

```bash
npm run start:legacy
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
```bash
node src/server.js
```

## üìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**
   ```bash
   npm start
   ```
   –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   üöÄ Starting ErrorParty Backend...
   üì¶ Architecture: Modular
   üìä Connecting to database...
   ‚úÖ Database connection established
   üì¶ Loading modules...
     ‚úì admin
     ‚úì auth
     ‚úì cs2
     ‚úì home
     ‚úì notifications
     ‚úì quests
     ‚úì teamspeak
     ‚úì user
   ‚úÖ Loaded 8 modules
   üöÄ Initializing modules...
     ‚úì Routes registered: /api/bot
     üîß Admin module ready
     ‚úì Routes registered: /api/auth
     üîê Auth module ready
     ‚úì Routes registered: /api/cs2
     üéÆ CS2 module ready
     ... –∏ —Ç.–¥.
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤**
   ```bash
   # Health check
   curl http://localhost:3001/api/health

   # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
   {
     "status": "OK",
     "timestamp": "...",
     "service": "errorparty-backend",
     "version": "2.0.0",
     "architecture": "modular"
   }
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π**
   - Auth: `GET /api/auth/steam`
   - CS2: `GET /api/cs2/stats/:steamId`
   - Quests: `GET /api/quests`
   - User: `GET /api/user/profile` (—Ç—Ä–µ–±—É–µ—Ç auth)
   - TeamSpeak: `GET /api/teamspeak/status`
   - Notifications: `GET /api/notifications` (—Ç—Ä–µ–±—É–µ—Ç auth)
   - Home: `GET /api/home`

## üîß –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `modules/{module}/index.js` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```javascript
module.exports = {
  name: 'modulename',
  routePrefix: '/api/modulename',
  routes: require('./modulename.routes'),
  async initialize(app, io) {
    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  }
};
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –∏–º–ø–æ—Ä—Ç–æ–≤. –í –º–æ–¥—É–ª—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏:
- Middleware: `../../shared/middleware/auth`
- Models: `../../models`
- Services: `../../services/someService`

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç–∞—Ä—ã–µ —Ä–æ—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `routePrefix` –≤ –º–æ–¥—É–ª–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å—Ç–∞—Ä—ã–º –ø—É—Ç–µ–º:
```javascript
// –°—Ç–∞—Ä—ã–π –ø—É—Ç—å –±—ã–ª /api/cs2/*
routePrefix: '/api/cs2'  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
routePrefix: '/cs2'       // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –§–∞–∑–∞ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Socket.IO —Å–æ–±—ã—Ç–∏—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ë–î

### –§–∞–∑–∞ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Dockerfile
```dockerfile
# –ò–∑–º–µ–Ω–∏—Ç—å CMD –≤ Dockerfile
CMD ["node", "src/index.js"]
```

### –§–∞–∑–∞ 3: –î–æ—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª–µ–π
- –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –≤ —Å–µ—Ä–≤–∏—Å—ã
- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è
- –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

### –§–∞–∑–∞ 4: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞
–ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π server.js (—Å–¥–µ–ª–∞—Ç—å backup!)
mv src/server.js src/server.js.backup

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ middleware, utils, config
# (–æ–Ω–∏ —Ç–µ–ø–µ—Ä—å –≤ shared/)
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ: `backend/MODULAR_ARCHITECTURE.md`

## üÜò –û—Ç–∫–∞—Ç

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏:

1. **–í package.json:**
   ```json
   "main": "src/server.js",
   "scripts": {
     "start": "node src/server.js"
   }
   ```

2. **–í Dockerfile:**
   ```dockerfile
   CMD ["node", "src/server.js"]
   ```

3. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**
   ```bash
   docker-compose up -d --build backend
   ```

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–æ–¥—É–ª–µ
2. **–ò–∑–æ–ª—è—Ü–∏—è** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–æ–¥—É–ª–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ
3. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–æ–¥—É–ª–∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏
5. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
6. **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–¥ —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏
7. **–ü–µ—Ä–µ—Ö–æ–¥ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º** - –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –º–æ–¥—É–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
