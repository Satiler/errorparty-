# ===========================================
# Система автообновления плейлистов - Конфигурация
# ===========================================

# ============================================
# БАЗА ДАННЫХ
# ============================================
# PostgreSQL connection string
DATABASE_URL=postgresql://music_user:password@localhost:5432/music_db

# Альтернативный формат (раздельно)
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=music_db
# DB_USER=music_user
# DB_PASSWORD=password

# ============================================
# REDIS (опционально, для кеширования)
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=2

# ============================================
# SPOTIFY API
# ============================================
# Получить на: https://developer.spotify.com/dashboard
SPOTIFY_CLIENT_ID=your_spotify_client_id_here
SPOTIFY_CLIENT_SECRET=your_spotify_client_secret_here

# ============================================
# APPLE MUSIC API
# ============================================
# Получить на: https://developer.apple.com
APPLE_TEAM_ID=your_apple_team_id
APPLE_KEY_ID=your_apple_key_id
APPLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----"

# ============================================
# SHAZAM API (через RapidAPI)
# ============================================
# Получить на: https://rapidapi.com/apidojo/api/shazam
SHAZAM_API_KEY=your_rapidapi_key_here

# ============================================
# KISSVK
# ============================================
KISSVK_API_URL=https://kissvk.com/api
KISSVK_BASE_URL=https://kissvk.com

# ============================================
# ХРАНИЛИЩЕ ФАЙЛОВ
# ============================================
# Локальный путь для сохранения музыки
MUSIC_STORAGE_PATH=d:/МОЙ САЙТ/uploads/music

# CDN URL для доступа к файлам
CDN_URL=https://yourdomain.com/uploads/music

# Максимальный размер файла (в байтах)
MAX_FILE_SIZE=20971520

# ============================================
# СЕРВЕР
# ============================================
# Порт для API автообновления
AUTO_UPDATE_PORT=3001

# Окружение (development, production)
NODE_ENV=production

# Таймзона для планировщика
TZ=Europe/Moscow

# ============================================
# ПЛАНИРОВЩИК ЗАДАЧ
# ============================================
# Расписание обновления плейлистов (cron формат)
# По умолчанию: ежедневно в 3:00
CHARTS_UPDATE_CRON=0 3 * * *

# Расписание импорта с kissvk (cron формат)
# По умолчанию: ежедневно в 4:00
KISSVK_IMPORT_CRON=0 4 * * *

# Включить/выключить планировщик
SCHEDULER_ENABLED=true

# ============================================
# НАСТРОЙКИ АЛГОРИТМА
# ============================================
# Минимальный порог рейтинга для добавления трека (0-1)
MIN_SCORE_THRESHOLD=0.6

# Максимальный размер плейлиста
MAX_PLAYLIST_SIZE=100

# Процент обновления за раз (0-1)
UPDATE_PERCENTAGE=0.15

# Требуется модерация изменений (true/false)
REQUIRE_MODERATION=true

# Автоматическое применение изменений без модерации
AUTO_APPLY_CHANGES=false

# Время жизни трека в плейлисте (дни)
TRACK_TTL=30

# ============================================
# ВЕСА ИСТОЧНИКОВ
# ============================================
# Веса для расчёта рейтинга треков (должны в сумме давать 1.0)
WEIGHT_SPOTIFY=0.30
WEIGHT_APPLE_MUSIC=0.25
WEIGHT_BILLBOARD=0.25
WEIGHT_SHAZAM=0.20

# ============================================
# ЛОГИРОВАНИЕ
# ============================================
# Уровень логирования (debug, info, warn, error)
LOG_LEVEL=info

# Путь к файлам логов
LOG_PATH=./logs

# Включить логирование в файл
LOG_TO_FILE=true

# Включить логирование в консоль
LOG_TO_CONSOLE=true

# ============================================
# УВЕДОМЛЕНИЯ
# ============================================
# Email уведомления
ENABLE_EMAIL_NOTIFICATIONS=false
EMAIL_RECIPIENTS=admin@yourdomain.com,manager@yourdomain.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Telegram уведомления
ENABLE_TELEGRAM_NOTIFICATIONS=false
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHAT_ID=your_telegram_chat_id

# ============================================
# БЕЗОПАСНОСТЬ
# ============================================
# JWT секрет для API аутентификации
JWT_SECRET=your_jwt_secret_key_here

# CORS разрешённые origins
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================
# ПРОКСИ (опционально)
# ============================================
# Использовать прокси для внешних запросов
USE_PROXY=false
PROXY_HOST=proxy.example.com
PROXY_PORT=8080
PROXY_USER=proxy_username
PROXY_PASSWORD=proxy_password

# ============================================
# ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ
# ============================================
# Таймаут для HTTP запросов (мс)
REQUEST_TIMEOUT=30000

# Максимальное количество попыток повтора при ошибке
MAX_RETRIES=3

# Задержка между запросами к внешним API (мс)
REQUEST_DELAY=2000

# Максимальное количество одновременных запросов
MAX_CONCURRENT_REQUESTS=5

# Включить кеширование
ENABLE_CACHE=true

# Время жизни кеша (секунды)
CACHE_TTL=3600

# ============================================
# ИМПОРТ С KISSVK
# ============================================
# Максимальное количество импортов в день
MAX_DAILY_IMPORTS=200

# Максимальное количество одновременных загрузок
MAX_CONCURRENT_DOWNLOADS=5

# Включить дедупликацию
ENABLE_DEDUPLICATION=true

# Порог схожести для дедупликации (0-1)
DEDUPLICATION_THRESHOLD=0.85

# ============================================
# ПЕРСОНАЛИЗАЦИЯ
# ============================================
# Минимальный порог схожести для рекомендаций (0-1)
RECOMMENDATION_SIMILARITY_THRESHOLD=0.3

# Количество рекомендаций по умолчанию
DEFAULT_RECOMMENDATIONS_LIMIT=20

# Вес популярности в рекомендациях (0-1)
POPULARITY_WEIGHT=0.3

# ============================================
# МОНИТОРИНГ И МЕТРИКИ
# ============================================
# Включить сбор метрик
ENABLE_METRICS=true

# Интервал сохранения метрик (секунды)
METRICS_INTERVAL=60

# Путь к Prometheus metrics endpoint
METRICS_PATH=/metrics

# ============================================
# РАЗРАБОТКА
# ============================================
# Включить debug режим
DEBUG=false

# Порт для hot reload (только для development)
DEV_PORT=3002

# Включить mock API для тестирования
USE_MOCK_API=false
